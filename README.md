# NadVibS
Nonadiabatic vibrational spectrum simulation package

Originate from NADVIBS.X by Michael Schuurman 2007

## Featured utilities
NadVibS.exe:
* Diagonalize diabatic vibronic Hamiltonian
* Determine Franck-Condon overlap
* Generate input file for BROOKLYN to calculate spin-orbit fine structure

modify.py:
* Renormalize, rescale, invert, shift the spectrum
* Throw out the lines with 0 intensity

plot.py:
* Plot the simulated line spectrum
* Plot continuous spectrum

## Usage
Python scripts are simple: use -h argument to show help message

To run NadVibS, use command: mpirun -hostfile hostfile -np `#CPU` `NadVibSDirectory`/NadVibS.exe -m `MemoryInMB` -o `OutputDirectory` > log

NadVibS requires 2 input files: nadvibs.in & basis.in, an example is provided. nadvibs.in will be automatically generated by SurfGenBound (see https://github.com/YifanShenSZ/SurfGenBound for details). However, user has to take care of the FORTRAN namelist file basis.in:
* restart   = 0, new job; else, restart
* niter     = number of lanczos iterations to be performed
* basis     = number of basis functions for each vibrational mode
* initstate = the initial vibrational state of the precursor (specified by the quanta of each precursor normal mode)
* nstates   = number of electronic states
* ordr      = order of the expansion for diabatic hamiltonian
* natoms    = number of atoms in molecule
* nmodes    = number of vibrational modes
* nirreps   = number of irreducible representations in point group symmetry
* npirr     = number of normal modes in each irreducible representation
* shiftref  = 0, do not use new origin; else, use new origin
* bconv     = (default 0) -lg( convergence tolerence for eigen value )
* idroots   = (default 0) how many of the lead contributors to a vibronic level to identify
* soroots   = (default 0) number of roots to compute spin orbit parameters
* reorthog  = (default 0) >0, request re-orthogonalization; >1, exact dot products are to be used to monitor lanczos vector orthogonality 
* chkorthog = (default 100) every how many iterations compute exact dot products if using recurrence
* nseg      = (default 1) number of segements to divide lanczos vector into
* ztoler    = (default 1d-20) Any coefficient less ztoler is set to 0
* maxdisk   = (default 1000) maximum amount of disk available for use (in MB)
* weights   = (default 1) initial weights of the electronic states

## Dependency
Global Arrays 5.4 or later

## Reference:
> 1. M. S. Schuurman, R. A. Young, D. R. Yarkony 2007 Chem. Phys.
> 2. M. S. Schuurman, D. Yarkony 2008 J. Chem. Phys.